<!--pages/my/index.wxml-->
<view class="container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¡ç‰‡ -->
  <view class="user-card">
    <view class="user-main">
      <view class="avatar-section">
        <image class="user-avatar" src="{{userInfo?.avatarUrl || '/assets/default-avatar.png'}}" mode="aspectFill" />
        <view class="credit-badge {{creditInfo.level}}">
          {{creditInfo.badge}}
        </view>
      </view>
      <view class="user-info">
        <view class="user-header">
          <text class="user-name">{{userInfo?.nickName || 'æˆ‘'}}</text>
          <view class="level-tag {{creditInfo.level}}">
            {{creditInfo.name}}
          </view>
        </view>
        <view class="credit-display">
          <text class="credit-score">{{userInfo?.creditScore || 60}}</text>
          <text class="credit-label">ä¿¡ç”¨åˆ†</text>
        </view>
      </view>
    </view>
    
    <!-- ç»Ÿè®¡æ•°æ® -->
    <view class="stats-bar">
      <view class="stat-item">
        <text class="stat-value">{{userInfo?.totalStats?.totalHelped || 0}}</text>
        <text class="stat-label">ç´¯è®¡å¸®åŠ©</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{userInfo?.totalStats?.totalPublished || 0}}</text>
        <text class="stat-label">ç´¯è®¡å‘å¸ƒ</text>
      </view>
      <view class="stat-item">
        <text class="stat-value">{{userInfo?.totalStats?.streakDays || 0}}</text>
        <text class="stat-label">è¿ç»­ç™»å½•</text>
      </view>
    </view>
  </view>

  <!-- ä»Šæ—¥ä»»åŠ¡ -->
  <view class="task-card">
    <view class="task-header">
      <text class="task-title">ğŸ“Š ä»Šæ—¥ä»»åŠ¡</text>
      <text class="task-date">{{todayDate}}</text>
    </view>
    <view class="task-list">
      <view class="task-item">
        <view class="task-icon-wrapper {{todayTask?.helped >= 2 ? 'completed' : ''}}">
          <text wx:if="{{todayTask?.helped >= 2}}">âœ“</text>
          <text wx:else>1</text>
        </view>
        <view class="task-content">
          <text class="task-name">äº’åŠ©ä»»åŠ¡</text>
          <text class="task-desc">é¢†å–2ä¸ªç¤¼åŒ…</text>
        </view>
        <view class="task-status">
          <text class="status-text {{todayTask?.helped >= 2 ? 'completed' : ''}}">
            {{todayTask?.helped || 0}}/2
          </text>
        </view>
      </view>
      <view class="task-item">
        <view class="task-icon-wrapper">
          <text>2</text>
        </view>
        <view class="task-content">
          <text class="task-name">å‘å¸ƒé¢åº¦</text>
          <text class="task-desc">æ¯æ—¥å¯å‘å¸ƒ{{dailyQuota}}ä¸ª</text>
        </view>
        <view class="task-status">
          <text class="status-text">{{todayTask?.published || 0}}/{{dailyQuota}}</text>
        </view>
      </view>
    </view>
  </view>

  <!-- å¾½ç« å±•ç¤º -->
  <view wx:if="{{achievements?.length > 0}}" class="badge-card">
    <view class="badge-header">
      <text class="badge-title">ğŸ… æˆ‘çš„å¾½ç« </text>
      <text class="badge-count">{{achievements.length}}ä¸ª</text>
    </view>
    <view class="badge-list">
      <view class="badge-item" wx:for="{{achievements.slice(0, 4)}}" wx:key="index">
        <text class="badge-emoji">{{item.emoji}}</text>
        <text class="badge-name">{{item.name}}</text>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-card">
    <view class="menu-item" bindtap="goToMyPackages">
      <view class="menu-icon">
        <text>ğŸ“¦</text>
      </view>
      <text class="menu-name">æˆ‘çš„åˆ†äº«</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="goToHelpHistory">
      <view class="menu-icon">
        <text>ğŸ¤</text>
      </view>
      <text class="menu-name">æˆ‘çš„å¸®åŠ©</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="goToCreditHistory">
      <view class="menu-icon">
        <text>ğŸ“ˆ</text>
      </view>
      <text class="menu-name">ä¿¡ç”¨è®°å½•</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="goToLeaderboard">
      <view class="menu-icon">
        <text>ğŸ†</text>
      </view>
      <text class="menu-name">æ’è¡Œæ¦œ</text>
      <text class="menu-arrow">â€º</text>
    </view>
    <view class="menu-item" bindtap="goToRules">
      <view class="menu-icon">
        <text>ğŸ“–</text>
      </view>
      <text class="menu-name">è§„åˆ™è¯´æ˜</text>
      <text class="menu-arrow">â€º</text>
    </view>
  </view>
</view>