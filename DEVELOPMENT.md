# ç‚¹ç‚¹åœˆ DotCircle - å¼€å‘æ–‡æ¡£

> ä¸€ä¸ªçº¯å…¬ç›Šçš„è…¾è®¯å…ƒå®æŠ½å¥–äº’åŠ©å¹³å°ï¼Œé€šè¿‡ä¿¡ç”¨ä½“ç³»å»ºç«‹è‰¯æ€§äº’åŠ©ç”Ÿæ€ã€‚
>
> **æ ¸å¿ƒç†å¿µï¼š** å…ˆåŠ©äººï¼Œåå—åŠ©ã€‚ä¿¡ç”¨è¶Šå¥½ï¼Œæ›å…‰è¶Šé«˜ã€‚

---

## ç›®å½•

1. [é¡¹ç›®æ¦‚è¿°](#é¡¹ç›®æ¦‚è¿°)
2. [åŠŸèƒ½è§„æ ¼ä¹¦](#åŠŸèƒ½è§„æ ¼ä¹¦)
3. [æ•°æ®åº“è®¾è®¡](#æ•°æ®åº“è®¾è®¡)
4. [APIæ¥å£è®¾è®¡](#apiæ¥å£è®¾è®¡)
5. [é¡µé¢ç»“æ„](#é¡µé¢ç»“æ„)
6. [å¼€å‘è®¡åˆ’](#å¼€å‘è®¡åˆ’)
7. [æŠ€æœ¯è§„èŒƒ](#æŠ€æœ¯è§„èŒƒ)
8. [éƒ¨ç½²é…ç½®](#éƒ¨ç½²é…ç½®)
9. [è´¹ç”¨é¢„ç®—](#è´¹ç”¨é¢„ç®—)
10. [é£é™©è¯„ä¼°](#é£é™©è¯„ä¼°)

---

## é¡¹ç›®æ¦‚è¿°

### èƒŒæ™¯

è…¾è®¯å…ƒå®åˆ†äº«æŠ½å¥–æ´»åŠ¨å¯¼è‡´å¾®ä¿¡ç¾¤ä¹ŒçƒŸç˜´æ°”ï¼Œå­˜åœ¨ä»¥ä¸‹ç—›ç‚¹ï¼š
1. å¾®ä¿¡ç¾¤åˆ·å±ä¸¥é‡
2. æŠ½å¥–ç¤¼åŒ…é¢†å–ç‡ä½
3. ç¼ºä¹æœ‰æ•ˆçš„äº’åŠ©æœºåˆ¶

### è§£å†³æ–¹æ¡ˆ

**ç‚¹ç‚¹åœˆ** æä¾›ç»“æ„åŒ–äº’åŠ©å¹³å°ï¼š
- ç”¨æˆ·å¿…é¡»å…ˆå¸®åŠ©ä»–äººï¼Œæ‰èƒ½å‘å¸ƒè‡ªå·±çš„ç¤¼åŒ…
- ä¿¡ç”¨ä½“ç³»ç¡®ä¿è‰¯æ€§ç”Ÿæ€
- æ›å…‰æœºåˆ¶æ¿€åŠ±é«˜è´¨é‡äº’åŠ©

### æ ¸å¿ƒæœºåˆ¶

```
ç”¨æˆ·è¿›å…¥å¹³å°
    â†“
é¢†å–2ä¸ªä»–äººç¤¼åŒ…ï¼ˆå®Œæˆäº’åŠ©ä»»åŠ¡ï¼‰
    â†“
è·å¾—å‘å¸ƒèµ„æ ¼
    â†“
å‘å¸ƒè‡ªå·±çš„ç¤¼åŒ…
    â†“
å…¶ä»–ç”¨æˆ·é¢†å–ï¼Œå®Œæˆé—­ç¯
```

### å¹³å°å®šä½

- **çº¯å…¬ç›Šæ€§è´¨**ï¼šæ— ç°é‡‘å¥–åŠ±ï¼Œä»…æä¾›äº’åŠ©åœºæ‰€
- **ä¿¡ç”¨é©±åŠ¨**ï¼šé€šè¿‡ä¿¡ç”¨åˆ†æ§åˆ¶æƒé™å’Œæ›å…‰
- **å¯é…ç½®åŒ–**ï¼šæ‰€æœ‰åŠŸèƒ½æ”¯æŒåå°å¼€å…³
- **é›¶æˆæœ¬å¯åŠ¨**ï¼šåŸºäºå¾®ä¿¡äº‘å¼€å‘å…è´¹é¢åº¦

---

## åŠŸèƒ½è§„æ ¼ä¹¦

### 1. ç”¨æˆ·ç³»ç»Ÿ

#### 1.1 æ³¨å†Œä¸ç™»å½•

- **ç™»å½•æ–¹å¼**ï¼šå¾®ä¿¡ä¸€é”®ç™»å½•
- **é¦–æ¬¡æ³¨å†Œ**ï¼š
  - ä¿¡ç”¨åˆ†ï¼š60åˆ†ï¼ˆä¸€èˆ¬ç­‰çº§ï¼‰
  - æ¯æ—¥é¢åº¦ï¼š2ä¸ªç¤¼åŒ…
  - å‘å¸ƒéœ€å®¡æ ¸ï¼šæ˜¯

#### 1.2 ç­‰çº§ä½“ç³»

| ç­‰çº§ | ä¿¡ç”¨åˆ† | åç§° | æ¯æ—¥é¢åº¦ | æ›å…‰æƒé‡ | æ ‡è¯† | ç‰¹æƒ |
|------|--------|------|----------|----------|------|------|
| ğŸ† | 90-100 | ä¼˜ç§€ | 3ä¸ª | 2.0x | é‡‘è‰² | å…å®¡+ç½®é¡¶å±•ç¤º |
| â­ | 75-89 | è‰¯å¥½ | 2ä¸ª | 1.5x | é“¶è‰² | å…å®¡æ ¸ |
| ğŸ”¹ | 60-74 | ä¸€èˆ¬ | 2ä¸ª | 1.0x | è“è‰² | éœ€å®¡æ ¸ |
| âš ï¸ | 40-59 | è­¦å‘Š | 1ä¸ª | 0.5x | æ©™è‰² | éœ€å®¡æ ¸ |
| ğŸš« | 20-39 | å—é™ | 0ä¸ª | 0x | ç°è‰² | ç¦æ­¢å‘å¸ƒ |
| âŒ | 0-19 | å°ç¦ | 0ä¸ª | 0x | çº¢è‰² | ç¦æ­¢ç™»å½• |

#### 1.3 æ¯æ—¥ä»»åŠ¡

| ä»»åŠ¡ | è¦æ±‚ | å¥–åŠ± |
|------|------|------|
| äº’åŠ©ä»»åŠ¡ | é¢†å–2ä¸ªç¤¼åŒ… | å‘å¸ƒèµ„æ ¼ |
| æ¯æ—¥äº’åŠ© | æ¯æ¬¡äº’åŠ© | +1ä¿¡ç”¨åˆ†ï¼ˆä¸Šé™2åˆ†/å¤©ï¼‰ |
| è¿ç»­ç™»å½• | è¿ç»­7å¤© | +5ä¿¡ç”¨åˆ† |

### 2. ç¤¼åŒ…ç³»ç»Ÿ

#### 2.1 åˆ†äº«ç®¡ç†åŠŸèƒ½

ç”¨æˆ·å¯åœ¨"æˆ‘çš„åˆ†äº«"é¡µé¢ç®¡ç†è‡ªå·±å‘å¸ƒçš„ç¤¼åŒ…ï¼š

**åŠŸèƒ½æ¸…å•ï¼š**

| åŠŸèƒ½ | è¯´æ˜ | è§¦å‘æ¡ä»¶ | å½±å“ |
|------|------|----------|------|
| æŸ¥çœ‹åˆ†äº« | æŸ¥çœ‹æ‰€æœ‰å‘å¸ƒçš„ç¤¼åŒ…åˆ—è¡¨ | - | - |
| å–æ¶ˆåˆ†äº« | åˆ é™¤ç¤¼åŒ…ï¼Œåœæ­¢é¢†å– | ä»»æ„çŠ¶æ€ | å·²é¢†å–è®°å½•ä¿ç•™ï¼Œæœªé¢†å–è€…æ— æ³•ç»§ç»­ |
| æ›´æ­£é¢†å–æ•° | æ‰‹åŠ¨è°ƒæ•´å·²é¢†å–äººæ•° | ç¤¼åŒ…è¢«å¹³å°å¤–é¢†å– | æ›´æ–°helpCountï¼Œé¿å…é‡å¤é¢†å– |
| ç¼–è¾‘ä¿¡æ¯ | ä¿®æ”¹ç¤¼åŒ…æè¿°/å›¾ç‰‡ | å®¡æ ¸æœªé€šè¿‡æˆ–å¾…å®¡æ ¸ | é‡æ–°æäº¤å®¡æ ¸ |

**æ›´æ­£é¢†å–æ•°åœºæ™¯ï¼š**
```
ç”¨æˆ·Aåœ¨ç‚¹ç‚¹åœˆå‘å¸ƒç¤¼åŒ…ï¼ˆ10äººé¢†å®Œæœ‰å¥–ï¼‰
    â†“
åˆ†äº«åˆ°å¾®ä¿¡ç¾¤ï¼Œè¢«æœ‹å‹é¢†å–äº†3äºº
    â†“
å›åˆ°ç‚¹ç‚¹åœˆï¼Œå‘ç°åªæ˜¾ç¤º0äººé¢†å–
    â†“
è¿›å…¥åˆ†äº«ç®¡ç† â†’ æ›´æ­£é¢†å–æ•° â†’ è®¾ç½®ä¸º3
    â†“
ç³»ç»Ÿæ›´æ–°ï¼šhelpCount=3ï¼Œå‰©ä½™7ä¸ªåé¢
```

**æ›´æ­£è§„åˆ™ï¼š**
- åªèƒ½å¢åŠ ï¼Œä¸èƒ½å‡å°‘ï¼ˆé˜²æ­¢ä½œå¼Šï¼‰
- æœ€å¤§ä¸èƒ½è¶…è¿‡maxHelpï¼ˆé»˜è®¤10ï¼‰
- éœ€è¦æä¾›è¯´æ˜ï¼ˆå¦‚"åˆ†äº«åˆ°å¾®ä¿¡ç¾¤é¢†äº†3äºº"ï¼‰
- è®°å½•æ›´æ­£å†å²
- ä¿¡ç”¨åˆ†>60æ‰èƒ½ä½¿ç”¨æ›´æ­£åŠŸèƒ½

#### 2.2 å‘å¸ƒæ¨¡å¼

**é“¾æ¥æ¨¡å¼ï¼š**
- è¾“å…¥å…ƒå®æŠ½å¥–é“¾æ¥
- æ ¼å¼éªŒè¯ï¼š`https://yb.tencent.com/fes/red/claim*`
- æå– `red_packet_id` å»é‡

**å›¾ç‰‡æ¨¡å¼ï¼š**
- ä¸Šä¼ äºŒç»´ç å›¾ç‰‡
- å­˜å‚¨åˆ°äº‘å­˜å‚¨
- äººå·¥å®¡æ ¸ï¼ˆæš‚ä¸æ”¯æŒOCRï¼‰

#### 2.2 å‘å¸ƒè§„åˆ™

1. **å‰ææ¡ä»¶**ï¼šä»Šæ—¥å·²å®Œæˆâ‰¥2æ¬¡äº’åŠ©
2. **é¢åº¦é™åˆ¶**ï¼šæ ¹æ®ç­‰çº§æ¯æ—¥é™é¢
3. **å®¡æ ¸æœºåˆ¶**ï¼š
   - ä¿¡ç”¨åˆ†â‰¥75ï¼šè‡ªåŠ¨é€šè¿‡
   - ä¿¡ç”¨åˆ†<75ï¼šè¿›å…¥äººå·¥å®¡æ ¸é˜Ÿåˆ—
4. **è¶…æ—¶å¤„ç†**ï¼š24å°æ—¶æœªå®¡æ ¸è‡ªåŠ¨æ‹’ç»

#### 2.3 ç¤¼åŒ…çŠ¶æ€

```
pending    â†’ å¾…å®¡æ ¸
active     â†’ è¿›è¡Œä¸­ï¼ˆå¯é¢†å–ï¼‰
completed  â†’ å·²å®Œæˆï¼ˆ10äººé¢†å®Œï¼‰
expired    â†’ å·²è¿‡æœŸï¼ˆ7å¤©åï¼‰
rejected   â†’ å·²æ‹’ç»ï¼ˆå®¡æ ¸æœªé€šè¿‡ï¼‰
```

#### 2.4 æ•°æ®ç»“æ„

```javascript
{
  _id: ObjectId,
  creatorOpenid: String,
  type: 'LINK' | 'IMAGE',
  
  // é“¾æ¥æ¨¡å¼
  giftUrl: String,
  giftId: String,              // red_packet_id
  
  // å›¾ç‰‡æ¨¡å¼
  imageFileId: String,
  imageUrl: String,
  
  // é€šç”¨å­—æ®µ
  status: String,
  helpCount: Number,           // å½“å‰å¸®åŠ©æ•°
  maxHelp: 10,
  helpers: [{
    openid: String,
    helpedAt: Date
  }],
  
  // å®¡æ ¸ä¿¡æ¯
  auditInfo: {
    auditor: String,
    result: String,
    reason: String,
    auditedAt: Date
  },
  
  createdAt: Date,
  expireAt: Date
}
```

### 3. ä¿¡ç”¨åˆ†ä½“ç³»

#### 3.1 æ‰£åˆ†é¡¹

| è¡Œä¸º | æ‰£åˆ† | è§¦å‘æ¡ä»¶ | å¤‡æ³¨ |
|------|------|----------|------|
| è™šå‡é“¾æ¥/å›¾ç‰‡ | -20 | ä¸¾æŠ¥æ ¸å® | ç¤¼åŒ…ä¸‹æ¶ |
| é¢†å–æ— å¥–åŠ± | -10 | ç”¨æˆ·åé¦ˆæ ¸å® | - |
| åƒåœ¾å¹¿å‘Š | -30 | ä¸¾æŠ¥æ ¸å® | ä¸¥é‡è¿è§„ |
| æœªå±¥è¡Œå¥‘çº¦ | -5 | 24å°æ—¶æœªå‘ | è‡ªåŠ¨æ£€æµ‹ |
| æ¶æ„ä¸¾æŠ¥ | -2 | ä¸¾æŠ¥æ— æ•ˆ | ç´¯è®¡3æ¬¡ç¦ä¸¾æŠ¥7å¤© |
| ä½œå¼Šè¡Œä¸º | -50 | ç³»ç»Ÿæ£€æµ‹ | äººå·¥å¤æ ¸ |

#### 3.2 åŠ åˆ†é¡¹

| è¡Œä¸º | åŠ åˆ† | é¢‘ç‡é™åˆ¶ | å¤‡æ³¨ |
|------|------|----------|------|
| æ¯æ—¥äº’åŠ© | +1 | 2æ¬¡/å¤© | å³æ—¶åˆ°è´¦ |
| è¿ç»­7å¤©äº’åŠ© | +5 | 7å¤©ä¸€æ¬¡ |  streakå¥–åŠ± |
| æœ‰æ•ˆä¸¾æŠ¥ | +3 | æ— ä¸Šé™ | æ ¸å®åå‘æ”¾ |
| å±¥è¡Œå¥‘çº¦ | +2 | æ¯æ¬¡ | 24å°æ—¶å†…å‘å¸ƒ |
| 30å¤©è‡ªç„¶æ¢å¤ | +5 | 30å¤©ä¸€æ¬¡ | è‡ªåŠ¨å‘æ”¾ |

#### 3.3 æ¢å¤æœºåˆ¶ï¼ˆæ··åˆæ¨¡å¼ï¼‰

```javascript
// æ—¶é—´æ¢å¤
æ¯30å¤©è‡ªåŠ¨ +5åˆ†

// ä»»åŠ¡æ¢å¤
è¿ç»­7å¤©äº’åŠ©          +3åˆ†
æˆåŠŸå¸®åŠ©ä»–äºº5æ¬¡      +2åˆ†
æœ‰æ•ˆä¸¾æŠ¥1æ¬¡          +2åˆ†

// é™åˆ¶
æ¯æ—¥æœ€å¤šæ¢å¤ï¼š5åˆ†
```

### 4. æ’è¡Œæ¦œç³»ç»Ÿ

#### 4.1 æ¦œå•ç±»å‹

| æ¦œå• | æŒ‡æ ‡ | å‘¨æœŸ | æ›´æ–°é¢‘ç‡ |
|------|------|------|----------|
| äº’åŠ©è¾¾äººæ¦œ | å¸®åŠ©äººæ•° | å‘¨æ¦œ | æ¯å°æ—¶ |
| ä¿¡ç”¨ä¹‹æ˜Ÿæ¦œ | ä¿¡ç”¨åˆ†æ•° | å®æ—¶ | å³æ—¶ |
| æ´»è·ƒå…ˆé”‹æ¦œ | è¿ç»­ç™»å½•å¤©æ•° | æ—¥æ¦œ | æ¯å¤© |
| è´¡çŒ®æ¦œ | ç´¯è®¡å‘å¸ƒæ•° | æœˆæ¦œ | æ¯å¤© |

#### 4.2 éšç§ä¿æŠ¤

**æ‰“ç è§„åˆ™ï¼š**
```javascript
// é•¿åº¦<3ï¼šæ˜¾ç¤ºé¦–å­— + "**"
"å¼ ä¸‰" â†’ "å¼ **"

// é•¿åº¦â‰¥3ï¼šé¦–å­— + æ˜Ÿå· + å°¾å­—
"æå°æ˜" â†’ "æ*æ˜"
"HelloWorld" â†’ "H*******d"
```

**ç‰¹æ®Šæ˜¾ç¤ºï¼š**
- å½“å‰ç”¨æˆ·ï¼šæ˜¾ç¤ºå®Œæ•´æ˜µç§° + "(ä½ )"æ ‡è®°
- Top 3ï¼šé‡‘è‰²è¾¹æ¡†é«˜äº®
- å¥½å‹ï¼ˆäº’ç›¸å…³æ³¨ï¼‰ï¼šå¯é€‰æ‹©æ˜¾ç¤ºå®Œæ•´

#### 4.3 æ¦œå•å¥–åŠ±

- **Top 10**ï¼šç‰¹æ®Šå¾½ç«  + æ¯æ—¥é¢å¤–+1å‘å¸ƒé¢åº¦
- **Top 3**ï¼šé¦–é¡µè½®æ’­å±•ç¤º24å°æ—¶
- **ç™»é¡¶**ï¼šå…¨ç«™å…¬å‘Šï¼ˆå¯é€‰å…³é—­ï¼‰

### 5. ä¸¾æŠ¥ç³»ç»Ÿ

#### 5.1 ä¸¾æŠ¥ç±»å‹

```javascript
REPORT_TYPES = {
  FAKE_LINK: 'é“¾æ¥æ— æ•ˆ/æ‰“ä¸å¼€',
  FAKE_IMAGE: 'å›¾ç‰‡è™šå‡/è¿‡æœŸ',
  NO_REWARD: 'é¢†å–åæ— å¥–åŠ±',
  SPAM: 'åƒåœ¾å¹¿å‘Šä¿¡æ¯',
  WRONG_PLATFORM: 'éå…ƒå®å¹³å°',
  HARASSMENT: 'éªšæ‰°/ä¸å½“è¡Œä¸º',
  OTHER: 'å…¶ä»–é—®é¢˜'
}
```

#### 5.2 å¤„ç†æœºåˆ¶ï¼ˆæ–¹æ¡ˆCï¼‰

```
ç”¨æˆ·ä¸¾æŠ¥
    â†“
0-6å°æ—¶ï¼šç­‰å¾…äººå·¥å®¡æ ¸
    â†“
6-24å°æ—¶ï¼šè‡ªåŠ¨å¤„ç†
    â”œâ”€ åŒä¸€ç›®æ ‡è¢«ä¸¾æŠ¥â‰¥3æ¬¡ â†’ è‡ªåŠ¨ä¸‹æ¶ + æ‰£åˆ†
    â””â”€ ä»…1æ¬¡ä¸¾æŠ¥ â†’ æ ‡è®°ä¸º"æ— æ•ˆ"
    â†“
24å°æ—¶æœªå¤„ç†
    â””â”€ æ‰§è¡Œè‡ªåŠ¨å¤„ç†ç»“æœ
```

#### 5.3 å¥–æƒ©è§„åˆ™

- **ä¸¾æŠ¥æˆåŠŸ**ï¼šä¸¾æŠ¥è€… +3åˆ†ï¼Œè¢«ä¸¾æŠ¥è€…æŒ‰ç±»å‹æ‰£åˆ†
- **ä¸¾æŠ¥æ— æ•ˆ**ï¼šä¸¾æŠ¥è€… -2åˆ†
- **æ¶æ„ä¸¾æŠ¥**ï¼šç´¯è®¡3æ¬¡æ— æ•ˆä¸¾æŠ¥ï¼Œç¦æ­¢ä¸¾æŠ¥åŠŸèƒ½7å¤©

#### 5.4 ç”³è¯‰æœºåˆ¶

- è¢«å¤„ç½šç”¨æˆ·å¯åœ¨72å°æ—¶å†…ç”³è¯‰
- ç®¡ç†å‘˜å¤æ ¸åå¯æ’¤é”€å¤„ç½š
- æ’¤é”€åæ¢å¤ä¿¡ç”¨åˆ†ï¼Œä½†ä¸è¿½æº¯æ›å…‰æŸå¤±

### 6. äº’åŠ©å¥‘çº¦ï¼ˆå¯å¼€å…³ï¼‰

#### 6.1 å¥‘çº¦æœºåˆ¶

```
ç”¨æˆ·Aå‘å¸ƒç¤¼åŒ… â†â”€â”€å¥‘çº¦â”€â”€â†’ ç”¨æˆ·Bé¢†å–
                      â†“
              Bå¿…é¡»åœ¨24å°æ—¶å†…å‘å¸ƒè‡ªå·±çš„ç¤¼åŒ…
                      â†“
              å®Œæˆï¼š+2åˆ† | è¿çº¦ï¼š-5åˆ†
```

#### 6.2 å¥‘çº¦çŠ¶æ€

```javascript
contract: {
  enabled: Boolean,      // æ˜¯å¦å¼€å¯å¥‘çº¦
  deadline: Date,        // æˆªæ­¢æ—¶é—´ï¼ˆ24å°æ—¶åï¼‰
  fulfilled: Boolean,    // æ˜¯å¦å®Œæˆ
  penaltyApplied: Boolean // æ˜¯å¦å·²æ‰£åˆ†
}
```

#### 6.3 æé†’æœºåˆ¶

- **18å°æ—¶**ï¼šå‘é€æé†’é€šçŸ¥
- **23å°æ—¶**ï¼šç´§æ€¥æé†’
- **24å°æ—¶**ï¼šè‡ªåŠ¨æ£€æµ‹ï¼Œæœªå‘å¸ƒåˆ™æ‰£åˆ†

### 7. äº’åŠ©ç¾¤ç»„ï¼ˆå¯å¼€å…³ï¼‰

#### 7.1 ç¾¤ç»„è§„åˆ™

- **åˆ›å»ºæ¡ä»¶**ï¼šä¿¡ç”¨åˆ†â‰¥75
- **äººæ•°ä¸Šé™**ï¼š50äºº
- **åŠ å…¥æ–¹å¼**ï¼šç”³è¯·åˆ¶æˆ–é‚€è¯·åˆ¶

#### 7.2 ç¾¤ç»„ç‰¹æƒ

- ç¾¤å†…æˆå‘˜ç¤¼åŒ…ä¼˜å…ˆå±•ç¤º
- ç¾¤ç»„ä¸“å±æ’è¡Œæ¦œ
- ç¾¤ç»„å†…äº’åŠ©é¢å¤–+1åˆ†å¥–åŠ±

#### 7.3 ç¾¤ç»„ç®¡ç†

- ç¾¤ä¸»å¯è®¾ç½®æœ€ä½ä¿¡ç”¨åˆ†è¦æ±‚
- å¯è¸¢å‡ºè¿è§„æˆå‘˜
- å¯è½¬è®©ç¾¤ä¸»

### 8. æˆå°±å¾½ç« ï¼ˆå¯å¼€å…³ï¼‰

#### 8.1 å¾½ç« åˆ—è¡¨

| å¾½ç«  | åç§° | è·å¾—æ¡ä»¶ | ç‰¹æƒ |
|------|------|----------|------|
| ğŸ… | åˆæ¥ä¹åˆ° | æ³¨å†Œå®Œæˆ | - |
| ğŸ¥‰ | äº’åŠ©æ–°æ‰‹ | å¸®åŠ©3äºº | - |
| ğŸ¥ˆ | äº’åŠ©è¾¾äºº | å¸®åŠ©50äºº | æ›å…‰+10% |
| ğŸ¥‡ | äº’åŠ©ä¹‹æ˜Ÿ | å¸®åŠ©200äºº | æ›å…‰+20% |
| ğŸ’ | ä¿¡ç”¨æ¨¡èŒƒ | ä¿¡ç”¨90+ä¿æŒ30å¤© | æ¯æ—¥+1é¢åº¦ |
| ğŸ”¥ | è¿ç»­æ‰“å¡ | è¿ç»­7å¤©ç™»å½• | æ›å…‰+5% |
| ğŸŒŸ | ä¸¾æŠ¥å…ˆé”‹ | æœ‰æ•ˆä¸¾æŠ¥10æ¬¡ | ä¸¾æŠ¥+1åˆ† |
| ğŸ‘‘ | ç¾¤ä¸» | åˆ›å»ºç¾¤ç»„ | ç¾¤ç»„ç®¡ç†æƒ |

#### 8.2 å±•ç¤ºä½ç½®

- ä¸ªäººä¸»é¡µå¾½ç« å¢™
- ç¤¼åŒ…åˆ—è¡¨æ˜µç§°æ—
- æ’è¡Œæ¦œå¤´åƒæ¡†

---

## æ•°æ®åº“è®¾è®¡

### é›†åˆæ€»è§ˆ

| é›†åˆå | ä¸»è¦ç”¨é€” | é¢„ä¼°æ•°æ®é‡ | ç´¢å¼•ç­–ç•¥ |
|--------|----------|------------|----------|
| users | ç”¨æˆ·æ•°æ® | 10ä¸‡+ | _openid(å”¯ä¸€) |
| packages | ç¤¼åŒ…æ•°æ® | 100ä¸‡+ | creatorOpenid, status, createdAt |
| helpRecords | å¸®åŠ©è®°å½• | 1000ä¸‡+ | packageId, helperOpenid, helpedAt |
| reports | ä¸¾æŠ¥æ•°æ® | 10ä¸‡+ | targetId, status, createdAt |
| creditHistory | ä¿¡ç”¨è®°å½• | 1000ä¸‡+ | _openid, timestamp |
| groups | ç¾¤ç»„æ•°æ® | 1000+ | creatorOpenid |
| groupMembers | ç¾¤ç»„æˆå‘˜ | 5ä¸‡+ | groupId, userOpenid |
| leaderboards | æ’è¡Œæ¦œ | 4æ¡/æ¬¡ | type, period |
| systemConfig | ç³»ç»Ÿé…ç½® | 1æ¡ | _id |
| adminLogs | ç®¡ç†å‘˜æ—¥å¿— | 10ä¸‡+ | adminOpenid, timestamp |

### è¯¦ç»†Schema

#### usersï¼ˆç”¨æˆ·è¡¨ï¼‰

```javascript
{
  // åŸºç¡€ä¿¡æ¯
  _openid: String,              // å¾®ä¿¡OpenIDï¼ˆå”¯ä¸€ï¼‰
  unionid: String,              // å¾®ä¿¡UnionIDï¼ˆå¯é€‰ï¼‰
  nickName: String,             // æ˜µç§°
  avatarUrl: String,            // å¤´åƒURL
  
  // ä¿¡ç”¨ç³»ç»Ÿ
  creditScore: Number,          // å½“å‰ä¿¡ç”¨åˆ†ï¼ˆé»˜è®¤60ï¼‰
  creditLevel: String,          // ç­‰çº§ï¼šEXCELLENT/GOOD/NORMAL/WARNING/RESTRICTED/BANNED
  
  // æ¯æ—¥ç»Ÿè®¡
  dailyStats: {
    date: String,               // æ—¥æœŸï¼ˆYYYY-MM-DDï¼‰
    helped: Number,             // ä»Šæ—¥å¸®åŠ©æ¬¡æ•°
    published: Number,          // ä»Šæ—¥å‘å¸ƒæ¬¡æ•°
    quota: Number               // ä»Šæ—¥å‰©ä½™é¢åº¦
  },
  
  // ç´¯è®¡ç»Ÿè®¡
  totalStats: {
    totalHelped: Number,        // ç´¯è®¡å¸®åŠ©
    totalPublished: Number,     // ç´¯è®¡å‘å¸ƒ
    totalReceived: Number,      // ç´¯è®¡è¢«é¢†å–
    streakDays: Number,         // è¿ç»­ç™»å½•å¤©æ•°
    lastActive: Date            // æœ€åæ´»è·ƒæ—¶é—´
  },
  
  // æˆå°±
  achievements: [String],       // å·²è·å¾—å¾½ç« ä»£ç åˆ—è¡¨
  
  // ç¾¤ç»„
  groupId: String,              // æ‰€å±ç¾¤ç»„IDï¼ˆå¯é€‰ï¼‰
  groupRole: String,            // è§’è‰²ï¼šmember/admin/owner
  
  // æƒé™
  isAdmin: Boolean,             // æ˜¯å¦ç®¡ç†å‘˜
  adminPermissions: [String],   // æƒé™åˆ—è¡¨ï¼šaudit/config/userManage
  
  // è®¾ç½®
  settings: {
    publicLeaderboard: Boolean, // æ˜¯å¦å…¬å¼€æ’è¡Œæ¦œ
    enableContract: Boolean,    // æ˜¯å¦å¼€å¯å¥‘çº¦æé†’
    allowNotification: Boolean  // æ˜¯å¦å…è®¸æ¨é€
  },
  
  // é£æ§
  riskFlags: [String],          // é£é™©æ ‡è®°
  bannedUntil: Date,            // å°ç¦æˆªæ­¢æ—¶é—´
  
  // æ—¶é—´æˆ³
  createdAt: Date,
  updatedAt: Date
}

// ç´¢å¼•
// db.users.createIndex({ _openid: 1 }, { unique: true })
// db.users.createIndex({ creditScore: -1 })
// db.users.createIndex({ "dailyStats.date": 1, creditScore: -1 })
```

#### packagesï¼ˆç¤¼åŒ…è¡¨ï¼‰

```javascript
{
  // åŸºç¡€ä¿¡æ¯
  _id: ObjectId,
  creatorOpenid: String,        // å‘å¸ƒè€…OpenID
  
  // ç±»å‹
  type: String,                 // LINKï¼ˆé“¾æ¥ï¼‰/ IMAGEï¼ˆå›¾ç‰‡ï¼‰
  
  // é“¾æ¥æ¨¡å¼å­—æ®µ
  giftUrl: String,              // å®Œæ•´é“¾æ¥
  giftId: String,               // red_packet_idï¼ˆå»é‡ç”¨ï¼‰
  
  // å›¾ç‰‡æ¨¡å¼å­—æ®µ
  imageFileId: String,          // äº‘å­˜å‚¨æ–‡ä»¶ID
  imageUrl: String,             // ä¸´æ—¶è®¿é—®é“¾æ¥
  
  // çŠ¶æ€
  status: String,               // pending/active/completed/expired/rejected
  
  // å®¡æ ¸ä¿¡æ¯
  auditInfo: {
    auditor: String,            // å®¡æ ¸ç®¡ç†å‘˜OpenID
    result: String,             // approved/rejected
    reason: String,             // æ‹’ç»åŸå› 
    auditedAt: Date
  },
  
  // å¸®åŠ©ä¿¡æ¯
  helpCount: Number,            // å½“å‰å¸®åŠ©æ•°ï¼ˆ0-10ï¼‰
  maxHelp: Number,              // æœ€å¤§å¸®åŠ©æ•°ï¼ˆå›ºå®š10ï¼‰
  helpers: [{
    openid: String,             // å¸®åŠ©è€…OpenID
    helpedAt: Date,             // å¸®åŠ©æ—¶é—´
    contractId: String          // å…³è”å¥‘çº¦ID
  }],
  
  // å¥‘çº¦
  contract: {
    enabled: Boolean,           // æ˜¯å¦å¼€å¯å¥‘çº¦
  },
  
  // ä¸¾æŠ¥
  reports: [{
    reportId: String,           // ä¸¾æŠ¥è®°å½•ID
    reporter: String,           // ä¸¾æŠ¥è€…
    reason: String,
    createdAt: Date
  }],
  reportCount: Number,          // ä¸¾æŠ¥æ¬¡æ•°ï¼ˆç”¨äºè‡ªåŠ¨å¤„ç†ï¼‰
  
  // æ›å…‰
  exposureScore: Number,        // æ›å…‰åˆ†æ•°ï¼ˆåŠ¨æ€è®¡ç®—ï¼‰
  
  // ç®¡ç†æ“ä½œè®°å½•
  management: {
    // æ›´æ­£é¢†å–æ•°å†å²
    helpCountAdjustments: [{
      from: Number,             // åŸæ•°é‡
      to: Number,               // æ–°æ•°é‡
      reason: String,           // æ›´æ­£åŸå› 
      adjustedAt: Date,         // æ›´æ­£æ—¶é—´
      adjustedBy: String        // æ“ä½œè€…ï¼ˆè‡ªå·±æˆ–adminï¼‰
    }],
    // å–æ¶ˆåˆ†äº«è®°å½•
    cancelledAt: Date,          // å–æ¶ˆæ—¶é—´
    cancelledBy: String,        // å–æ¶ˆè€…
    cancelReason: String        // å–æ¶ˆåŸå› ï¼ˆå¯é€‰ï¼‰
  },
  
  // æ—¶é—´æˆ³
  createdAt: Date,
  updatedAt: Date,
  expireAt: Date                // è¿‡æœŸæ—¶é—´ï¼ˆ7å¤©åï¼‰
}

// ç´¢å¼•
// db.packages.createIndex({ creatorOpenid: 1, createdAt: -1 })
// db.packages.createIndex({ status: 1, createdAt: -1 })
// db.packages.createIndex({ status: 1, exposureScore: -1 })
// db.packages.createIndex({ expireAt: 1 }, { expireAfterSeconds: 0 })
```

#### helpRecordsï¼ˆå¸®åŠ©è®°å½•è¡¨ï¼‰

```javascript
{
  _id: ObjectId,
  packageId: ObjectId,          // ç¤¼åŒ…ID
  creatorOpenid: String,        // å‘å¸ƒè€…OpenIDï¼ˆå†—ä½™ï¼Œæ–¹ä¾¿æŸ¥è¯¢ï¼‰
  helperOpenid: String,         // å¸®åŠ©è€…OpenID
  
  // å¥‘çº¦
  contract: {
    enabled: Boolean,
    fulfilled: Boolean,
    fulfilledAt: Date
  },
  
  // è®¾å¤‡ä¿¡æ¯ï¼ˆé£æ§ï¼‰
  deviceInfo: {
    fingerprint: String,        // è®¾å¤‡æŒ‡çº¹ï¼ˆç®€åŒ–ç‰ˆï¼‰
    platform: String            // ios/android
  },
  
  helpedAt: Date
}

// ç´¢å¼•
// db.helpRecords.createIndex({ packageId: 1, helperOpenid: 1 }, { unique: true })
// db.helpRecords.createIndex({ helperOpenid: 1, helpedAt: -1 })
// db.helpRecords.createIndex({ creatorOpenid: 1, helpedAt: -1 })
```

#### reportsï¼ˆä¸¾æŠ¥è¡¨ï¼‰

```javascript
{
  _id: ObjectId,
  reporterOpenid: String,       // ä¸¾æŠ¥è€…
  
  // ä¸¾æŠ¥ç›®æ ‡
  targetType: String,           // PACKAGE / USER
  targetId: String,             // ç¤¼åŒ…IDæˆ–ç”¨æˆ·ID
  targetCreator: String,        // å¦‚æœæ˜¯ç¤¼åŒ…ï¼Œè®°å½•å‘å¸ƒè€…
  
  // ä¸¾æŠ¥å†…å®¹
  reasonCode: String,           // é¢„è®¾åŸå› ä»£ç 
  reasonText: String,           // è¡¥å……è¯´æ˜
  evidence: String,             // è¯æ®ï¼ˆå›¾ç‰‡é“¾æ¥æˆ–æ–‡å­—ï¼‰
  
  // å¤„ç†çŠ¶æ€
  status: String,               // PENDING/PROCESSING/VALID/INVALID
  autoProcessed: Boolean,       // æ˜¯å¦è‡ªåŠ¨å¤„ç†
  
  // å¤„ç†ç»“æœ
  handledBy: String,            // å¤„ç†ç®¡ç†å‘˜
  result: String,               // å¤„ç†è¯´æ˜
  creditImpact: Number,         // å¯¹è¢«ä¸¾æŠ¥è€…çš„ä¿¡ç”¨å½±å“
  reporterReward: Number,       // å¯¹ä¸¾æŠ¥è€…çš„å¥–åŠ±
  
  // å…³è”æ“ä½œ
  relatedActions: [{
    type: String,               // package_removed/user_bannedç­‰
    targetId: String,
    timestamp: Date
  }],
  
  createdAt: Date,
  handledAt: Date
}

// ç´¢å¼•
// db.reports.createIndex({ targetId: 1, status: 1 })
// db.reports.createIndex({ status: 1, createdAt: 1 })
// db.reports.createIndex({ reporterOpenid: 1, createdAt: -1 })
```

#### creditHistoryï¼ˆä¿¡ç”¨è®°å½•è¡¨ï¼‰

```javascript
{
  _id: ObjectId,
  _openid: String,              // ç”¨æˆ·OpenID
  
  // å˜åŠ¨ä¿¡æ¯
  type: String,                 // ADDï¼ˆå¢åŠ ï¼‰/ DEDUCTï¼ˆæ‰£é™¤ï¼‰
  reason: String,               // åŸå› æè¿°
  reasonCode: String,           // åŸå› ä»£ç ï¼ˆä¾¿äºç»Ÿè®¡ï¼‰
  amount: Number,               // å˜åŠ¨åˆ†å€¼
  
  // ä½™é¢
  balanceBefore: Number,        // å˜åŠ¨å‰
  balanceAfter: Number,         // å˜åŠ¨å
  
  // å…³è”
  relatedType: String,          // å…³è”ç±»å‹ï¼šreport/help/contract/system
  relatedId: String,            // å…³è”è®°å½•ID
  
  // æ“ä½œè€…
  operator: String,             // æ“ä½œè€…ï¼ˆsystem/admin/openidï¼‰
  
  timestamp: Date
}

// ç´¢å¼•
// db.creditHistory.createIndex({ _openid: 1, timestamp: -1 })
// db.creditHistory.createIndex({ relatedId: 1 })
```

#### groupsï¼ˆç¾¤ç»„è¡¨ï¼‰

```javascript
{
  _id: ObjectId,
  name: String,                 // ç¾¤ç»„åç§°
  description: String,          // ç¾¤ç»„æè¿°
  avatarUrl: String,            // ç¾¤ç»„å¤´åƒ
  
  creatorOpenid: String,        // åˆ›å»ºè€…
  ownerOpenid: String,          // å½“å‰ç¾¤ä¸»
  
  // æˆå‘˜
  memberCount: Number,          // æˆå‘˜æ•°
  maxMembers: Number,           // æœ€å¤§æˆå‘˜æ•°ï¼ˆé»˜è®¤50ï¼‰
  
  // è®¾ç½®
  settings: {
    minCredit: Number,          // æœ€ä½ä¿¡ç”¨åˆ†è¦æ±‚
    inviteOnly: Boolean,        // æ˜¯å¦ä»…é‚€è¯·
    verifyRequired: Boolean     // æ˜¯å¦éœ€è¦å®¡æ ¸
  },
  
  // ç»Ÿè®¡
  stats: {
    totalPackages: Number,      // ç¾¤å†…å‘å¸ƒæ€»æ•°
    totalHelps: Number,         // ç¾¤å†…äº’åŠ©æ€»æ•°
    createdAt: Date
  },
  
  updatedAt: Date
}
```

#### groupMembersï¼ˆç¾¤ç»„æˆå‘˜è¡¨ï¼‰

```javascript
{
  _id: ObjectId,
  groupId: ObjectId,
  userOpenid: String,
  
  role: String,                 // member/admin/owner
  joinedAt: Date,
  
  // ç¾¤å†…ç»Ÿè®¡
  stats: {
    packagesCount: Number,      // åœ¨ç¾¤å†…å‘å¸ƒæ•°
    helpsCount: Number          // åœ¨ç¾¤å†…å¸®åŠ©æ•°
  }
}

// ç´¢å¼•
// db.groupMembers.createIndex({ groupId: 1, userOpenid: 1 }, { unique: true })
// db.groupMembers.createIndex({ userOpenid: 1 })
```

#### leaderboardsï¼ˆæ’è¡Œæ¦œè¡¨ï¼‰

```javascript
{
  _id: ObjectId,
  type: String,                 // helper/credit/active/contributor
  period: String,               // daily/weekly/monthly/all
  
  // æ¦œå•æ•°æ®
  data: [{
    rank: Number,               // æ’å
    openid: String,
    nickname: String,           // å·²æ‰“ç 
    avatarUrl: String,
    score: Number,              // åˆ†æ•°
    change: Number,             // æ’åå˜åŒ–ï¼ˆ+ä¸Šå‡/-ä¸‹é™ï¼‰
    isSelf: Boolean             // æ˜¯å¦å½“å‰æŸ¥çœ‹ç”¨æˆ·
  }],
  
  // ç»Ÿè®¡
  totalParticipants: Number,    // æ€»å‚ä¸äººæ•°
  updatedAt: Date,
  nextUpdateAt: Date            // ä¸‹æ¬¡æ›´æ–°æ—¶é—´
}

// ç´¢å¼•
// db.leaderboards.createIndex({ type: 1, period: 1 }, { unique: true })
```

#### systemConfigï¼ˆç³»ç»Ÿé…ç½®è¡¨ï¼‰

```javascript
{
  _id: 'system_config',
  version: '1.0.0',
  
  // ç®¡ç†å‘˜åˆ—è¡¨
  admins: [{
    openid: String,
    nickName: String,
    role: String,               // super/audit/config
    addedAt: Date,
    addedBy: String
  }],
  
  // åŠŸèƒ½å¼€å…³
  features: {
    basic: {
      enabled: true,
      requireAudit: true,
      autoPublishThreshold: 75
    },
    publish: {
      linkEnabled: true,
      imageEnabled: true,
      dailyQuota: 2
    },
    contract: {
      enabled: true,
      deadline: 24,               // å°æ—¶
      reminderAt: [18, 23]        // æé†’æ—¶é—´ç‚¹
    },
    groups: {
      enabled: true,
      maxMembers: 50,
      minCredit: 75
    },
    leaderboard: {
      enabled: true,
      privacy: 'masked',          // masked/full/nickname
      types: ['helper', 'credit', 'active', 'contributor']
    },
    achievements: {
      enabled: true
    },
    smartRecommend: {
      enabled: true,
      algorithm: 'credit_priority' // credit_priority/freshness/balanced
    }
  },
  
  // ä¿¡ç”¨è§„åˆ™é…ç½®
  creditRules: {
    // æ‰£åˆ†é¡¹
    penalties: {
      FAKE_LINK: { amount: -20, auto: false },
      FAKE_IMAGE: { amount: -20, auto: false },
      NO_REWARD: { amount: -10, auto: false },
      SPAM: { amount: -30, auto: true },
      CONTRACT_BREACH: { amount: -5, auto: true },
      FALSE_REPORT: { amount: -2, auto: true },
      CHEATING: { amount: -50, auto: false }
    },
    
    // åŠ åˆ†é¡¹
    rewards: {
      DAILY_HELP: { amount: 1, dailyMax: 2 },
      STREAK_7: { amount: 5, cooldown: 7 },
      VALID_REPORT: { amount: 3 },
      CONTRACT_FULFILL: { amount: 2 },
      RECOVERY_30D: { amount: 5, interval: 30 }
    },
    
    // ç­‰çº§é˜ˆå€¼
    levels: {
      EXCELLENT: 90,
      GOOD: 75,
      NORMAL: 60,
      WARNING: 40,
      RESTRICTED: 20,
      BANNED: 0
    }
  },
  
  // ä¸¾æŠ¥å¤„ç†é…ç½®
  reportConfig: {
    autoProcess: true,
    checkInterval: 6,             // 6å°æ—¶å¼€å§‹æ£€æŸ¥
    autoRemoveThreshold: 3,       // 3æ¬¡ä¸¾æŠ¥è‡ªåŠ¨ä¸‹æ¶
    validReward: 3,
    invalidPenalty: -2,
    falseReportLimit: 3,          // 3æ¬¡æ— æ•ˆç¦ä¸¾æŠ¥
    falseReportBanDays: 7
  },
  
  // æ•°æ®æ¸…ç†é…ç½®
  cleanup: {
    enabled: true,
    packageRetention: 7,          // ç¤¼åŒ…ä¿ç•™7å¤©
    recordRetention: 30,          // è®°å½•ä¿ç•™30å¤©
    logRetention: 90              // æ—¥å¿—ä¿ç•™90å¤©
  },
  
  // ç³»ç»Ÿç»Ÿè®¡
  stats: {
    totalUsers: 0,
    totalPackages: 0,
    pendingAudit: 0,
    todayActive: 0,
    lastUpdated: Date
  },
  
  updatedAt: Date,
  updatedBy: String
}
```

---

## APIæ¥å£è®¾è®¡

### æ¥å£è§„èŒƒ

**åŸºç¡€è·¯å¾„ï¼š** `wx.cloud.callFunction({ name: 'functionName' })`

**å“åº”æ ¼å¼ï¼š**
```javascript
{
  success: true/false,
  code: 200/400/401/403/404/500,
  message: 'é”™è¯¯ä¿¡æ¯',
  data: {}
}
```

### ç”¨æˆ·æ¨¡å—

#### login - ç”¨æˆ·ç™»å½•
```javascript
// è°ƒç”¨
wx.cloud.callFunction({
  name: 'login',
  data: {
    userInfo: { nickName, avatarUrl } // å¯é€‰
  }
})

// å“åº”
{
  success: true,
  data: {
    user: { /* ç”¨æˆ·ä¿¡æ¯ */ },
    isNewUser: false,
    todayTask: { helped: 1, needHelp: 2, canPublish: false }
  }
}
```

#### getUserInfo - è·å–ç”¨æˆ·ä¿¡æ¯
```javascript
wx.cloud.callFunction({
  name: 'getUserInfo',
  data: { openid: 'xxx' } // ä¸ä¼ åˆ™æŸ¥è‡ªå·±
})
```

#### updateSettings - æ›´æ–°è®¾ç½®
```javascript
wx.cloud.callFunction({
  name: 'updateSettings',
  data: {
    publicLeaderboard: true,
    enableContract: true
  }
})
```

### ç¤¼åŒ…æ¨¡å—

#### getPackages - è·å–ç¤¼åŒ…åˆ—è¡¨
```javascript
wx.cloud.callFunction({
  name: 'getPackages',
  data: {
    status: 'active',       // active/pending/completed/my
    sortBy: 'exposure',     // exposure/time/helpCount
    page: 1,
    limit: 20,
    groupId: 'xxx'          // å¯é€‰ï¼ŒæŸ¥çœ‹ç‰¹å®šç¾¤ç»„
  }
})
```

#### publishPackage - å‘å¸ƒç¤¼åŒ…
```javascript
wx.cloud.callFunction({
  name: 'publishPackage',
  data: {
    type: 'LINK',           // LINK/IMAGE
    giftUrl: 'https://...', // é“¾æ¥æ¨¡å¼
    // æˆ–
    imageFileId: 'cloud://...', // å›¾ç‰‡æ¨¡å¼
    enableContract: true
  }
})

// å“åº”
{
  success: true,
  data: {
    packageId: 'xxx',
    status: 'pending',      // pending/active
    message: 'å·²æäº¤å®¡æ ¸'
  }
}
```

#### helpPackage - å¸®åŠ©ç¤¼åŒ…ï¼ˆé¢†å–ï¼‰
```javascript
wx.cloud.callFunction({
  name: 'helpPackage',
  data: {
    packageId: 'xxx'
  }
})
```

#### getPackageDetail - è·å–ç¤¼åŒ…è¯¦æƒ…
```javascript
wx.cloud.callFunction({
  name: 'getPackageDetail',
  data: {
    packageId: 'xxx'
  }
})
```

#### getMyPackages - è·å–æˆ‘çš„åˆ†äº«åˆ—è¡¨
```javascript
wx.cloud.callFunction({
  name: 'getMyPackages',
  data: {
    status: 'all',          // all/active/completed/cancelled/pending
    page: 1,
    limit: 20
  }
})

// å“åº”
{
  success: true,
  data: {
    list: [{
      packageId: 'xxx',
      type: 'LINK',
      giftUrl: '...',
      status: 'active',
      helpCount: 5,
      maxHelp: 10,
      createdAt: Date,
      // ç®¡ç†æ“ä½œè®°å½•
      management: {
        adjustments: [{ from: 0, to: 3, reason: 'åˆ†äº«åˆ°å¾®ä¿¡ç¾¤é¢†äº†3äºº' }],
        isCancelled: false
      }
    }],
    total: 15,
    hasMore: true
  }
}
```

#### updatePackage - æ›´æ­£åˆ†äº«ä¿¡æ¯
```javascript
// ç”¨äºæ›´æ­£é¢†å–æ•°æˆ–ç¼–è¾‘æœªå®¡æ ¸é€šè¿‡çš„ç¤¼åŒ…
wx.cloud.callFunction({
  name: 'updatePackage',
  data: {
    packageId: 'xxx',
    action: 'adjust_help_count',  // adjust_help_count/edit_info
    // æ›´æ­£é¢†å–æ•°æ—¶
    helpCount: 5,                 // æ–°çš„å·²é¢†å–æ•°
    reason: 'åˆ†äº«åˆ°å¾®ä¿¡ç¾¤é¢†äº†5äºº', // å¿…é¡»æä¾›è¯´æ˜
    // ç¼–è¾‘ä¿¡æ¯æ—¶ï¼ˆä»…pending/rejectedçŠ¶æ€å¯ç”¨ï¼‰
    giftUrl: 'new_url',
    imageFileId: 'new_image'
  }
})

// å“åº”
{
  success: true,
  data: {
    packageId: 'xxx',
    helpCount: 5,
    remaining: 5,               // å‰©ä½™åé¢
    message: 'é¢†å–æ•°å·²æ›´æ­£ä¸º5ï¼Œå‰©ä½™5ä¸ªåé¢'
  }
}
```

#### cancelPackage - å–æ¶ˆåˆ†äº«
```javascript
wx.cloud.callFunction({
  name: 'cancelPackage',
  data: {
    packageId: 'xxx',
    reason: 'å·²ç»é¢†æ»¡äº†' // å¯é€‰
  }
})

// å“åº”
{
  success: true,
  data: {
    message: 'åˆ†äº«å·²å–æ¶ˆï¼Œè¯¥ç¤¼åŒ…å°†ä¸å†å±•ç¤º'
  }
}

// è§„åˆ™ï¼š
// 1. åªèƒ½å–æ¶ˆè‡ªå·±å‘å¸ƒçš„ç¤¼åŒ…
// 2. å·²å®Œæˆçš„ç¤¼åŒ…ï¼ˆ10äººé¢†å®Œï¼‰ä¸èƒ½å–æ¶ˆ
// 3. å–æ¶ˆåstatuså˜ä¸ºcancelled
// 4. å·²é¢†å–è®°å½•ä¿ç•™ï¼Œä½†ä¸å†æ¥å—æ–°çš„é¢†å–
// 5. ä¸è¿”è¿˜ä»Šæ—¥å‘å¸ƒé¢åº¦ï¼ˆå·²å‘å¸ƒå³æ¶ˆè€—é¢åº¦ï¼‰
```

### ä¿¡ç”¨æ¨¡å—

#### getCreditHistory - è·å–ä¿¡ç”¨è®°å½•
```javascript
wx.cloud.callFunction({
  name: 'getCreditHistory',
  data: {
    page: 1,
    limit: 20
  }
})
```

#### getCreditRules - è·å–ä¿¡ç”¨è§„åˆ™
```javascript
wx.cloud.callFunction({
  name: 'getCreditRules'
})
```

### æ’è¡Œæ¦œæ¨¡å—

#### getLeaderboard - è·å–æ’è¡Œæ¦œ
```javascript
wx.cloud.callFunction({
  name: 'getLeaderboard',
  data: {
    type: 'helper',         // helper/credit/active/contributor
    period: 'weekly'        // daily/weekly/monthly
  }
})
```

### ä¸¾æŠ¥æ¨¡å—

#### submitReport - æäº¤ä¸¾æŠ¥
```javascript
wx.cloud.callFunction({
  name: 'submitReport',
  data: {
    targetType: 'PACKAGE',
    targetId: 'package_id',
    reasonCode: 'FAKE_LINK',
    reasonText: 'é“¾æ¥æ‰“ä¸å¼€',
    evidence: 'screenshot_url' // å¯é€‰
  }
})
```

### ç¾¤ç»„æ¨¡å—

#### getGroups - è·å–ç¾¤ç»„åˆ—è¡¨
```javascript
wx.cloud.callFunction({
  name: 'getGroups',
  data: {
    page: 1,
    limit: 20
  }
})
```

#### createGroup - åˆ›å»ºç¾¤ç»„
```javascript
wx.cloud.callFunction({
  name: 'createGroup',
  data: {
    name: 'äº’åŠ©å°åˆ†é˜Ÿ',
    description: 'é«˜è´¨é‡äº’åŠ©ç¾¤',
    minCredit: 70,
    inviteOnly: false
  }
})
```

#### joinGroup - åŠ å…¥ç¾¤ç»„
```javascript
wx.cloud.callFunction({
  name: 'joinGroup',
  data: {
    groupId: 'xxx'
  }
})
```

### ç®¡ç†æ¨¡å—

#### adminAuditPackage - å®¡æ ¸ç¤¼åŒ…
```javascript
wx.cloud.callFunction({
  name: 'adminAuditPackage',
  data: {
    packageId: 'xxx',
    action: 'approve',      // approve/reject
    reason: 'ä¸ç¬¦åˆè§„èŒƒ'     // æ‹’ç»æ—¶å¿…å¡«
  }
})
```

#### adminHandleReport - å¤„ç†ä¸¾æŠ¥
```javascript
wx.cloud.callFunction({
  name: 'adminHandleReport',
  data: {
    reportId: 'xxx',
    action: 'valid',        // valid/invalid
    creditImpact: -20,      // å¯¹è¢«ä¸¾æŠ¥è€…å½±å“
    reason: 'æ ¸å®ä¸ºè™šå‡é“¾æ¥'
  }
})
```

#### adminAdjustCredit - è°ƒæ•´ä¿¡ç”¨åˆ†
```javascript
wx.cloud.callFunction({
  name: 'adminAdjustCredit',
  data: {
    openid: 'user_openid',
    amount: 10,             // æ­£æ•°åŠ åˆ†ï¼Œè´Ÿæ•°æ‰£åˆ†
    reason: 'è¡¥å¿'
  }
})
```

#### adminUpdateConfig - æ›´æ–°ç³»ç»Ÿé…ç½®
```javascript
wx.cloud.callFunction({
  name: 'adminUpdateConfig',
  data: {
    feature: 'contract.enabled',
    value: false
  }
})
```

#### adminGetStats - è·å–ç»Ÿè®¡æ•°æ®
```javascript
wx.cloud.callFunction({
  name: 'adminGetStats'
})
```

---

## é¡µé¢ç»“æ„

### é¡µé¢æ¸…å•

| é¡µé¢ | è·¯å¾„ | åŠŸèƒ½æè¿° | ä¼˜å…ˆçº§ |
|------|------|----------|--------|
| é¦–é¡µ | pages/index/index | ç¤¼åŒ…åˆ—è¡¨ï¼Œæ›å…‰æ’åº | P0 |
| å‘å¸ƒ | pages/publish/index | å‘å¸ƒç¤¼åŒ…ï¼ˆé“¾æ¥/å›¾ç‰‡ï¼‰ | P0 |
| ç¤¼åŒ…è¯¦æƒ… | pages/package/detail | ç¤¼åŒ…è¯¦æƒ…ï¼Œå¸®åŠ©æŒ‰é’® | P0 |
| æˆ‘çš„ | pages/my/index | ä¸ªäººä¸­å¿ƒï¼Œä»Šæ—¥ä»»åŠ¡ | P0 |
| **åˆ†äº«ç®¡ç†** | **pages/my/packages** | **ç®¡ç†æˆ‘çš„åˆ†äº«ï¼ˆå–æ¶ˆ/æ›´æ­£ï¼‰** | **P0** |
| ä¿¡ç”¨è®°å½• | pages/credit/history | ä¿¡ç”¨åˆ†å˜åŠ¨è®°å½• | P1 |
| æ’è¡Œæ¦œ | pages/leaderboard/index | 4ç±»æ¦œå• | P1 |
| ä¸¾æŠ¥ | pages/report/index | æäº¤ä¸¾æŠ¥ | P1 |
| ç¾¤ç»„ | pages/groups/index | ç¾¤ç»„åˆ—è¡¨ | P2 |
| ç¾¤ç»„è¯¦æƒ… | pages/groups/detail | ç¾¤ç»„å†…ç¤¼åŒ… | P2 |
| è§„åˆ™è¯´æ˜ | pages/rules/index | ä¿¡ç”¨è§„åˆ™/ä½¿ç”¨æ•™ç¨‹ | P1 |
| ç®¡ç†å‘˜åå° | admin/index.html | Webç®¡ç†ç«¯ | P1 |

### æ ¸å¿ƒé¡µé¢è®¾è®¡

#### 1. é¦–é¡µï¼ˆpages/index/indexï¼‰

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ” æœç´¢æ                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å…¨éƒ¨] [é“¾æ¥] [å›¾ç‰‡] [ç¾¤ç»„]   â”‚ â† Tabç­›é€‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ† ç”¨æˆ·A               â”‚   â”‚ â† ç¤¼åŒ…å¡ç‰‡
â”‚ â”‚ [å›¾ç‰‡] è¿˜å·®3äººé¢†æ»¡      â”‚   â”‚
â”‚ â”‚ 2åˆ†é’Ÿå‰ Â· æ›å…‰å€¼: 85   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ â­ ç”¨æˆ·B               â”‚   â”‚
â”‚ â”‚ [é“¾æ¥] å…ƒå®æŠ½å¥–         â”‚   â”‚
â”‚ â”‚ 5åˆ†é’Ÿå‰ Â· æ›å…‰å€¼: 72   â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚    [å‘å¸ƒæŒ‰é’® - æ‚¬æµ®]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ’åºç®—æ³•ï¼š**
```javascript
exposureScore = (
  baseScore: 50,
  + (creditLevel.weight * 20),    // ä¿¡ç”¨ç­‰çº§æƒé‡
  + (freshness * 30),              // æ–°é²œåº¦ï¼ˆå‘å¸ƒæ—¶é—´ï¼‰
  + (urgency * 15),                // ç´§æ€¥åº¦ï¼ˆå·®å‡ äººæ»¡ï¼‰
  + (random * 5)                   // éšæœºå› å­ï¼ˆé˜²åˆ·ï¼‰
)
```

#### 2. å‘å¸ƒé¡µï¼ˆpages/publish/indexï¼‰

**å‰ç½®æ£€æŸ¥ï¼š**
```javascript
// 1. æ£€æŸ¥ä»Šæ—¥äº’åŠ©æ•°
if (dailyStats.helped < 2) {
  showModal('è¯·å…ˆå®Œæˆä»Šæ—¥äº’åŠ©ä»»åŠ¡')
  return
}

// 2. æ£€æŸ¥å‘å¸ƒé¢åº¦
if (dailyStats.published >= dailyQuota) {
  showModal('ä»Šæ—¥å‘å¸ƒé¢åº¦å·²ç”¨å®Œ')
  return
}

// 3. æ£€æŸ¥ä¿¡ç”¨åˆ†
if (creditScore < 20) {
  showModal('ä¿¡ç”¨åˆ†è¿‡ä½ï¼Œæ— æ³•å‘å¸ƒ')
  return
}
```

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† å‘å¸ƒç¤¼åŒ…                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [ç²˜è´´é“¾æ¥] [ä¸Šä¼ å›¾ç‰‡]        â”‚ â† Tabåˆ‡æ¢
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  è¾“å…¥æ¡†ï¼šç²˜è´´å…ƒå®é“¾æ¥        â”‚
â”‚  æˆ–                         â”‚
â”‚  [+ ä¸Šä¼ äºŒç»´ç å›¾ç‰‡]          â”‚
â”‚                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â˜‘ï¸ å¼€å¯äº’åŠ©å¥‘çº¦             â”‚
â”‚   ï¼ˆ24å°æ—¶å†…éœ€å‘å¸ƒè‡ªå·±çš„ï¼‰   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     [ç¡®è®¤å‘å¸ƒ]              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3. æˆ‘çš„é¡µï¼ˆpages/my/indexï¼‰

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â”Œâ”€â”€â”€â”€â”€â”                    â”‚
â”‚  â”‚å¤´åƒ â”‚  ç”¨æˆ·æ˜µç§° ğŸ”¹       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”˜  ä¿¡ç”¨åˆ†: 60         â”‚
â”‚           ç­‰çº§: ä¸€èˆ¬         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“Š ä»Šæ—¥ä»»åŠ¡                  â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ äº’åŠ©è¿›åº¦ï¼šâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 2/2 â”‚   â”‚ â† å®Œæˆåå˜ç»¿è‰²
â”‚ â”‚ å‘å¸ƒé¢åº¦ï¼šâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘ 0/2 â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ… æˆ‘çš„å¾½ç«                   â”‚
â”‚ [ğŸ…][ğŸ¥‰][ğŸ”¥] æŸ¥çœ‹å…¨éƒ¨ â†’    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“‹ åŠŸèƒ½åˆ—è¡¨                  â”‚
â”‚ â”œâ”€ æˆ‘çš„å‘å¸ƒ                 â”‚
â”‚ â”œâ”€ æˆ‘çš„å¸®åŠ©                 â”‚
â”‚ â”œâ”€ ä¿¡ç”¨è®°å½•                 â”‚
â”‚ â”œâ”€ æ’è¡Œæ¦œ                   â”‚
â”‚ â”œâ”€ äº’åŠ©ç¾¤ç»„                 â”‚
â”‚ â”œâ”€ è®¾ç½®                     â”‚
â”‚ â””â”€ è§„åˆ™è¯´æ˜                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 4. åˆ†äº«ç®¡ç†é¡µï¼ˆpages/my/packagesï¼‰

**å¸ƒå±€ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† æˆ‘çš„åˆ†äº«                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [å…¨éƒ¨][è¿›è¡Œä¸­][å·²é¢†æ»¡][å·²å–æ¶ˆ]â”‚ â† Tabç­›é€‰
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ ğŸ”¹ è¿›è¡Œä¸­              â”‚   â”‚
â”‚ â”‚ [é“¾æ¥] å…ƒå®æŠ½å¥–         â”‚   â”‚
â”‚ â”‚ å·²é¢† 3/10              â”‚   â”‚
â”‚ â”‚                         â”‚   â”‚
â”‚ â”‚ [æ›´æ­£] [å–æ¶ˆåˆ†äº«] [æŸ¥çœ‹]â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ âœ… å·²é¢†æ»¡              â”‚   â”‚
â”‚ â”‚ [å›¾ç‰‡] äºŒç»´ç            â”‚   â”‚
â”‚ â”‚ å·²é¢† 10/10             â”‚   â”‚
â”‚ â”‚ å®Œæˆæ—¶é—´ï¼š2å°æ—¶å‰       â”‚   â”‚
â”‚ â”‚                         â”‚   â”‚
â”‚ â”‚ [æŸ¥çœ‹è¯¦æƒ…]             â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚ â”‚ âŒ å·²å–æ¶ˆ              â”‚   â”‚
â”‚ â”‚ [é“¾æ¥] å…ƒå®æŠ½å¥–         â”‚   â”‚
â”‚ â”‚ å–æ¶ˆæ—¶é—´ï¼š2026-02-01    â”‚   â”‚
â”‚ â”‚ åŸå› ï¼šå·²é¢†æ»¡            â”‚   â”‚
â”‚ â”‚                         â”‚   â”‚
â”‚ â”‚ [é‡æ–°å‘å¸ƒ]             â”‚   â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**æ›´æ­£é¢†å–æ•°å¼¹çª—ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     æ›´æ­£é¢†å–æ•°é‡            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚  å½“å‰æ˜¾ç¤ºï¼š3äººå·²é¢†           â”‚
â”‚                             â”‚
â”‚  å®é™…å·²é¢†ï¼š[    5    ]äºº    â”‚
â”‚                             â”‚
â”‚  æ›´æ­£è¯´æ˜ï¼š                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚åˆ†äº«åˆ°å¾®ä¿¡ç¾¤é¢†äº†2äºº    â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚
â”‚  âš ï¸ æ›´æ­£åå‰©ä½™5ä¸ªåé¢      â”‚
â”‚                             â”‚
â”‚    [å–æ¶ˆ]    [ç¡®è®¤æ›´æ­£]     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å–æ¶ˆåˆ†äº«å¼¹çª—ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      ç¡®è®¤å–æ¶ˆåˆ†äº«ï¼Ÿ          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                             â”‚
â”‚ å–æ¶ˆåè¯¥ç¤¼åŒ…å°†ä¸å†å±•ç¤ºï¼Œ    â”‚
â”‚ å…¶ä»–äººæ— æ³•ç»§ç»­é¢†å–ã€‚        â”‚
â”‚                             â”‚
â”‚ å–æ¶ˆåŸå› ï¼ˆå¯é€‰ï¼‰ï¼š          â”‚
â”‚ â”œâ”€ â—‹ å·²ç»é¢†æ»¡äº†            â”‚
â”‚ â”œâ”€ â—‹ é“¾æ¥å·²å¤±æ•ˆ            â”‚
â”‚ â”œâ”€ â—‹ ä¸æƒ³åˆ†äº«äº†            â”‚
â”‚ â””â”€ â—‹ å…¶ä»–åŸå›               â”‚
â”‚                             â”‚
â”‚    [æš‚ä¸å–æ¶ˆ]  [ç¡®è®¤å–æ¶ˆ]   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**é¡µé¢é€»è¾‘ï¼š**
```javascript
Page({
  data: {
    currentTab: 'all',  // all/active/completed/cancelled
    packages: [],
    hasMore: true
  },

  onLoad() {
    this.loadPackages()
  },

  // åŠ è½½åˆ†äº«åˆ—è¡¨
  async loadPackages() {
    const res = await wx.cloud.callFunction({
      name: 'getMyPackages',
      data: {
        status: this.data.currentTab,
        page: 1,
        limit: 20
      }
    })
    
    this.setData({
      packages: res.result.data.list
    })
  },

  // æ›´æ­£é¢†å–æ•°
  async handleAdjust(e) {
    const { packageId, currentCount } = e.currentTarget.dataset
    
    // å¼¹å‡ºè¾“å…¥æ¡†
    const { value } = await wx.showModal({
      title: 'æ›´æ­£é¢†å–æ•°é‡',
      editable: true,
      placeholderText: `å½“å‰æ˜¾ç¤º${currentCount}äºº`
    })
    
    const newCount = parseInt(value)
    
    // æ ¡éªŒ
    if (newCount <= currentCount) {
      wx.showToast({ title: 'åªèƒ½å¢åŠ ä¸èƒ½å‡å°‘', icon: 'none' })
      return
    }
    if (newCount > 10) {
      wx.showToast({ title: 'ä¸èƒ½è¶…è¿‡10äºº', icon: 'none' })
      return
    }
    
    // è¯·æ±‚æ›´æ­£
    const { reason } = await this.showReasonInput() // å¼¹å‡ºåŸå› è¾“å…¥
    
    await wx.cloud.callFunction({
      name: 'updatePackage',
      data: {
        packageId,
        action: 'adjust_help_count',
        helpCount: newCount,
        reason
      }
    })
    
    wx.showToast({ title: 'æ›´æ­£æˆåŠŸ' })
    this.loadPackages()
  },

  // å–æ¶ˆåˆ†äº«
  async handleCancel(e) {
    const { packageId } = e.currentTarget.dataset
    
    const { confirm } = await wx.showModal({
      title: 'ç¡®è®¤å–æ¶ˆåˆ†äº«ï¼Ÿ',
      content: 'å–æ¶ˆåå…¶ä»–äººå°†æ— æ³•é¢†å–',
      confirmText: 'ç¡®è®¤å–æ¶ˆ',
      cancelText: 'æš‚ä¸'
    })
    
    if (confirm) {
      await wx.cloud.callFunction({
        name: 'cancelPackage',
        data: { packageId }
      })
      
      wx.showToast({ title: 'å·²å–æ¶ˆåˆ†äº«' })
      this.loadPackages()
    }
  }
})
```

---

## å¼€å‘è®¡åˆ’

### Phase 1: åŸºç¡€æ¶æ„ï¼ˆç¬¬1-4å¤©ï¼‰

**Day 1: é¡¹ç›®åˆå§‹åŒ–**
- [ ] åˆ›å»ºå°ç¨‹åºé¡¹ç›®
- [ ] é…ç½®äº‘å¼€å‘ç¯å¢ƒ
- [ ] è®¾è®¡æ•°æ®åº“é›†åˆç»“æ„
- [ ] åˆ›å»ºæ•°æ®åº“ç´¢å¼•

**Day 2: å¾®ä¿¡ç™»å½•**
- [ ] å®ç°loginäº‘å‡½æ•°
- [ ] å‰ç«¯ç™»å½•æµç¨‹
- [ ] ç”¨æˆ·ä¿¡æ¯å­˜å‚¨
- [ ] æ–°ç”¨æˆ·åˆå§‹åŒ–ï¼ˆ60åˆ†ï¼‰

**Day 3: ç”¨æˆ·ç³»ç»Ÿ**
- [ ] ç”¨æˆ·ä¿¡æ¯è·å–API
- [ ] æ¯æ—¥ä»»åŠ¡ç»Ÿè®¡
- [ ] è¿ç»­ç™»å½•æ£€æµ‹
- [ ] ä¸ªäººä¸­å¿ƒé¡µé¢æ¡†æ¶

**Day 4: ç³»ç»Ÿé…ç½®**
- [ ] systemConfigé›†åˆ
- [ ] åŠŸèƒ½å¼€å…³è®¾è®¡
- [ ] ä¿¡ç”¨è§„åˆ™é…ç½®åŒ–
- [ ] ç®¡ç†å‘˜æƒé™ä½“ç³»

### Phase 2: æ ¸å¿ƒæµç¨‹ï¼ˆç¬¬5-9å¤©ï¼‰

**Day 5: å‘å¸ƒåŠŸèƒ½-é“¾æ¥æ¨¡å¼**
- [ ] URLæ ¼å¼éªŒè¯
- [ ] æå–giftIdå»é‡
- [ ] å‘å¸ƒå‰æ£€æŸ¥ï¼ˆäº’åŠ©æ•°/é¢åº¦/ä¿¡ç”¨ï¼‰
- [ ] å®¡æ ¸æµç¨‹ï¼ˆäººå·¥ï¼‰

**Day 6: å‘å¸ƒåŠŸèƒ½-å›¾ç‰‡æ¨¡å¼**
- [ ] å›¾ç‰‡ä¸Šä¼ åˆ°äº‘å­˜å‚¨
- [ ] ç”Ÿæˆä¸´æ—¶è®¿é—®é“¾æ¥
- [ ] å›¾ç‰‡ç¤¼åŒ…æ•°æ®ç»“æ„
- [ ] å›¾ç‰‡é¢„è§ˆåŠŸèƒ½

**Day 7: é¦–é¡µä¸åˆ—è¡¨**
- [ ] ç¤¼åŒ…åˆ—è¡¨API
- [ ] æ›å…‰æ’åºç®—æ³•
- [ ] é¦–é¡µUIå®ç°
- [ ] ä¸‹æ‹‰åˆ·æ–°/ä¸Šæ‹‰åŠ è½½

**Day 8: é¢†å–åŠŸèƒ½**
- [ ] å¸®åŠ©ç¤¼åŒ…API
- [ ] é˜²é‡å¤é¢†å–éªŒè¯
- [ ] å¸®åŠ©è®°å½•å­˜å‚¨
- [ ] å®æ—¶æ›´æ–°çŠ¶æ€

**Day 9: ä¿¡ç”¨åˆ†ç³»ç»Ÿ**
- [ ] ä¿¡ç”¨åˆ†å˜åŠ¨é€»è¾‘
- [ ] ç­‰çº§è‡ªåŠ¨è®¡ç®—
- [ ] æ¯æ—¥é¢åº¦é‡ç½®
- [ ] ä¿¡ç”¨è®°å½•å­˜å‚¨

### Phase 3: é«˜çº§åŠŸèƒ½ï¼ˆç¬¬10-14å¤©ï¼‰

**Day 10: ä¸¾æŠ¥ç³»ç»Ÿ**
- [ ] ä¸¾æŠ¥æäº¤API
- [ ] ä¸¾æŠ¥ç±»å‹é¢„è®¾
- [ ] 6-24å°æ—¶è‡ªåŠ¨å¤„ç†
- [ ] å¥–æƒ©æ‰§è¡Œé€»è¾‘

**Day 11: æ’è¡Œæ¦œ**
- [ ] 4ç±»æ¦œå•è®¡ç®—é€»è¾‘
- [ ] å®šæ—¶æ›´æ–°ä»»åŠ¡
- [ ] éšç§æ‰“ç å¤„ç†
- [ ] æ¦œå•UIå®ç°

**Day 12: äº’åŠ©å¥‘çº¦**
- [ ] å¥‘çº¦ç­¾è®¢é€»è¾‘
- [ ] 24å°æ—¶å€’è®¡æ—¶
- [ ] æé†’æ¨é€ï¼ˆå¯é€‰ï¼‰
- [ ] è¿çº¦è‡ªåŠ¨æ‰£åˆ†

**Day 13: ç¾¤ç»„ç³»ç»Ÿ**
- [ ] ç¾¤ç»„CRUD
- [ ] æˆå‘˜ç®¡ç†
- [ ] ç¾¤å†…ä¼˜å…ˆå±•ç¤º
- [ ] ç¾¤ç»„UIå®ç°

**Day 14: æˆå°±å¾½ç« **
- [ ] å¾½ç« å®šä¹‰
- [ ] è·å¾—æ¡ä»¶æ£€æµ‹
- [ ] å¾½ç« å±•ç¤º
- [ ] ç‰¹æƒåº”ç”¨ï¼ˆæ›å…‰åŠ æˆç­‰ï¼‰

### Phase 4: ç®¡ç†åå°ï¼ˆç¬¬15-17å¤©ï¼‰

**Day 15: Webç®¡ç†ç«¯åŸºç¡€**
- [ ] ç®¡ç†å‘˜ç™»å½•éªŒè¯
- [ ] ç¤¼åŒ…å®¡æ ¸ç•Œé¢
- [ ] ç”¨æˆ·ä¿¡ç”¨ç®¡ç†
- [ ] ä¸¾æŠ¥å¤„ç†ç•Œé¢

**Day 16: ç³»ç»Ÿç®¡ç†**
- [ ] åŠŸèƒ½å¼€å…³é…ç½®
- [ ] ä¿¡ç”¨è§„åˆ™è°ƒæ•´
- [ ] ç®¡ç†å‘˜æƒé™ç®¡ç†
- [ ] ç³»ç»Ÿç»Ÿè®¡æ•°æ®

**Day 17: æ•°æ®ç®¡ç†**
- [ ] å®šæ—¶æ¸…ç†ä»»åŠ¡
- [ ] æ•°æ®å¯¼å‡ºåŠŸèƒ½
- [ ] æ—¥å¿—æŸ¥è¯¢
- [ ] å…¬å‘Šå‘å¸ƒ

### Phase 5: æµ‹è¯•ä¼˜åŒ–ï¼ˆç¬¬18-20å¤©ï¼‰

**Day 18: åŠŸèƒ½æµ‹è¯•**
- [ ] å•å…ƒæµ‹è¯•
- [ ] é›†æˆæµ‹è¯•
- [ ] è¾¹ç•Œæƒ…å†µæµ‹è¯•
- [ ] Bugä¿®å¤

**Day 19: æ€§èƒ½ä¼˜åŒ–**
- [ ] æ•°æ®åº“æŸ¥è¯¢ä¼˜åŒ–
- [ ] äº‘å‡½æ•°æ€§èƒ½ä¼˜åŒ–
- [ ] å‰ç«¯æ€§èƒ½ä¼˜åŒ–
- [ ] ç¼“å­˜ç­–ç•¥

**Day 20: ä¸Šçº¿å‡†å¤‡**
- [ ] å®¡æ ¸ææ–™å‡†å¤‡
- [ ] éšç§åè®®
- [ ] ç”¨æˆ·åè®®
- [ ] æäº¤å¾®ä¿¡å®¡æ ¸

---

## æŠ€æœ¯è§„èŒƒ

### ä»£ç è§„èŒƒ

#### å‘½åçº¦å®š
```javascript
// å˜é‡ï¼šcamelCase
let userInfo = {}
let creditScore = 60
let isActive = true

// å¸¸é‡ï¼šUPPER_SNAKE
const MAX_HELP = 10
const DEFAULT_CREDIT = 60

// å‡½æ•°ï¼šcamelCaseï¼ŒåŠ¨è¯å¼€å¤´
function getUserInfo() {}
function handleSubmit() {}
function calculateExposure() {}

// æ–‡ä»¶ï¼škebab-case
// pages/user-profile/index.js
// cloudfunctions/update-credit/index.js

// ç»„ä»¶ï¼šPascalCaseï¼ˆå¦‚æœä½¿ç”¨è‡ªå®šä¹‰ç»„ä»¶ï¼‰
// components/PackageCard/PackageCard.wxml
```

#### æ³¨é‡Šè§„èŒƒ
```javascript
/**
 * è®¡ç®—ç¤¼åŒ…æ›å…‰åˆ†æ•°
 * @param {Object} package - ç¤¼åŒ…æ•°æ®
 * @param {Object} user - å½“å‰ç”¨æˆ·
 * @returns {Number} æ›å…‰åˆ†æ•°
 */
function calculateExposure(package, user) {
  // åŸºç¡€åˆ†æ•°
  let score = 50
  
  // æ ¹æ®ä¿¡ç”¨ç­‰çº§åŠ æƒ
  const levelWeights = {
    EXCELLENT: 2.0,
    GOOD: 1.5,
    NORMAL: 1.0,
    WARNING: 0.5
  }
  score *= levelWeights[user.level] || 1.0
  
  return score
}
```

### å®‰å…¨è§„èŒƒ

1. **æ•°æ®æ ¡éªŒ**
```javascript
// æ‰€æœ‰è¾“å…¥å¿…é¡»æ ¡éªŒ
function validateGiftUrl(url) {
  const pattern = /^https:\/\/yb\.tencent\.com\/fes\/red\/claim/
  return pattern.test(url)
}
```

2. **æƒé™æ£€æŸ¥**
```javascript
// æ•æ„Ÿæ“ä½œæ£€æŸ¥æƒé™
async function deletePackage(packageId, userOpenid) {
  const pkg = await db.collection('packages').doc(packageId).get()
  
  // åªèƒ½åˆ é™¤è‡ªå·±çš„
  if (pkg.data.creatorOpenid !== userOpenid) {
    throw new Error('æ— æƒé™')
  }
  
  // æˆ–æ£€æŸ¥æ˜¯å¦æ˜¯ç®¡ç†å‘˜
  const isAdmin = await checkAdmin(userOpenid)
  if (!isAdmin) {
    throw new Error('æ— æƒé™')
  }
}
```

3. **é˜²åˆ·é™åˆ¶**
```javascript
// é¢‘ç‡é™åˆ¶
const rateLimit = {
  publish: { count: 10, window: 60 },    // 60ç§’å†…æœ€å¤š10æ¬¡
  help: { count: 5, window: 60 },
  report: { count: 3, window: 300 }
}
```

### æ€§èƒ½ä¼˜åŒ–

1. **æ•°æ®åº“ä¼˜åŒ–**
```javascript
// ä½¿ç”¨ç´¢å¼•
// db.collection('packages').where({ status: 'active' }).orderBy('createdAt', 'desc')

// åˆ†é¡µæŸ¥è¯¢
function getPackages(page = 1, limit = 20) {
  return db.collection('packages')
    .skip((page - 1) * limit)
    .limit(limit)
    .get()
}

// åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
.field({ _openid: true, nickName: true, avatarUrl: true })
```

2. **äº‘å‡½æ•°ä¼˜åŒ–**
```javascript
// æ‰¹é‡æ“ä½œ
const batch = db.batch()
packages.forEach(pkg => {
  batch.update(pkg.ref, { status: 'expired' })
})
await batch.commit()

// å¹¶è¡ŒæŸ¥è¯¢
const [users, packages] = await Promise.all([
  getUsers(),
  getPackages()
])
```

3. **å‰ç«¯ä¼˜åŒ–**
```javascript
// å›¾ç‰‡æ‡’åŠ è½½
<image src="{{item.avatarUrl}}" lazy-load />

// åˆ—è¡¨è™šæ‹Ÿæ»šåŠ¨ï¼ˆæ•°æ®é‡å¤§æ—¶ï¼‰
// ä½¿ç”¨ recycle-view ç»„ä»¶

// æœ¬åœ°ç¼“å­˜
wx.setStorageSync('userInfo', userInfo)
```

---

## éƒ¨ç½²é…ç½®

### äº‘å¼€å‘ç¯å¢ƒ

```yaml
# project.config.json
{
  "cloudfunctionRoot": "cloudfunctions/",
  "cloudfunctionTemplateRoot": "cloudfunctionTemplate/",
  "setting": {
    "urlCheck": false,
    "es6": true,
    "enhance": true
  }
}
```

### äº‘å‡½æ•°åˆ—è¡¨

| å‡½æ•°å | åŠŸèƒ½ | è§¦å‘å™¨ | å†…å­˜é…ç½® |
|--------|------|--------|----------|
| login | ç”¨æˆ·ç™»å½• | HTTP | 128MB |
| user | ç”¨æˆ·ç›¸å…³æ“ä½œ | HTTP | 128MB |
| packages | ç¤¼åŒ…CRUD | HTTP | 256MB |
| help | å¸®åŠ©æ“ä½œ | HTTP | 128MB |
| credit | ä¿¡ç”¨åˆ†æ“ä½œ | HTTP | 128MB |
| report | ä¸¾æŠ¥å¤„ç† | HTTP | 128MB |
| leaderboard | æ’è¡Œæ¦œ | HTTP | 256MB |
| groups | ç¾¤ç»„æ“ä½œ | HTTP | 128MB |
| admin | ç®¡ç†æ“ä½œ | HTTP | 512MB |
| cleanup | æ•°æ®æ¸…ç† | Timer(æ¯å¤©4ç‚¹) | 256MB |
| updateLeaderboard | æ›´æ–°æ¦œå• | Timer(æ¯å°æ—¶) | 512MB |
| contractCheck | å¥‘çº¦æ£€æŸ¥ | Timer(æ¯å°æ—¶) | 128MB |
| reportProcessor | ä¸¾æŠ¥å¤„ç† | Timer(æ¯6å°æ—¶) | 256MB |

### å®šæ—¶ä»»åŠ¡é…ç½®

```json
// cloudfunctions/cleanup/config.json
{
  "triggers": [
    {
      "name": "cleanup",
      "type": "timer",
      "config": "0 0 4 * * * *"
    }
  ]
}

// cloudfunctions/updateLeaderboard/config.json
{
  "triggers": [
    {
      "name": "updateLeaderboard",
      "type": "timer",
      "config": "0 0 * * * * *"
    }
  ]
}

// cloudfunctions/contractCheck/config.json
{
  "triggers": [
    {
      "name": "contractCheck",
      "type": "timer",
      "config": "0 0 * * * * *"
    }
  ]
}
```

---

## è´¹ç”¨é¢„ç®—

### å…è´¹é¢åº¦ï¼ˆæ¯æœˆï¼‰

| èµ„æº | å…è´¹é¢åº¦ | é¢„ä¼°ç”¨é‡ | çŠ¶æ€ |
|------|----------|----------|------|
| äº‘å‡½æ•°è°ƒç”¨ | 500ä¸‡æ¬¡ | 10ä¸‡æ¬¡ | âœ… å……è¶³ |
| äº‘å‡½æ•°è¿è¡Œ | 10ä¸‡GBs | 5000GBs | âœ… å……è¶³ |
| æ•°æ®åº“è¯» | 500ä¸‡æ¬¡ | 50ä¸‡æ¬¡ | âœ… å……è¶³ |
| æ•°æ®åº“å†™ | 300ä¸‡æ¬¡ | 20ä¸‡æ¬¡ | âœ… å……è¶³ |
| äº‘å­˜å‚¨å®¹é‡ | 5GB | 2GB | âœ… å……è¶³ |
| äº‘å­˜å‚¨ä¸‹è½½ | 5GB | 1GB | âœ… å……è¶³ |
| CDNæµé‡ | 5GB | 2GB | âœ… å……è¶³ |

### é¢„æœŸè´¹ç”¨ï¼ˆè¶…å‡ºå…è´¹é¢åº¦åï¼‰

| ç”¨æˆ·æ•° | æœˆè´¹ç”¨ | ä¸»è¦æ¶ˆè€— |
|--------|--------|----------|
| 1,000 | Â¥0 | å…è´¹é¢åº¦å†… |
| 10,000 | Â¥0-50 | å¯èƒ½ç•¥è¶… |
| 50,000 | Â¥100-200 | æ•°æ®åº“è¯»å†™ |
| 100,000 | Â¥300-500 | äº‘å‡½æ•°+æ•°æ®åº“ |

**æˆæœ¬æ§åˆ¶æªæ–½ï¼š**
1. å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®
2. ä½¿ç”¨ç¼“å­˜å‡å°‘æ•°æ®åº“æŸ¥è¯¢
3. å›¾ç‰‡å‹ç¼©åä¸Šä¼ 
4. æ‰¹é‡æ“ä½œä»£æ›¿å•æ¡

---

## é£é™©è¯„ä¼°

### æŠ€æœ¯é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| å¾®ä¿¡å®¡æ ¸ä¸é€šè¿‡ | ä¸­ | é«˜ | å¼ºè°ƒå…¬ç›Šæ€§è´¨ï¼Œå‡†å¤‡å¤‡ç”¨æ–‡æ¡ˆ |
| ç”¨æˆ·é‡è¶…å‡ºå…è´¹é¢åº¦ | ä½ | ä¸­ | ç›‘æ§ä½¿ç”¨é‡ï¼Œè®¾ç½®å‘Šè­¦ |
| æ•°æ®åº“æ€§èƒ½ç“¶é¢ˆ | ä½ | ä¸­ | ä¼˜åŒ–ç´¢å¼•ï¼Œå¿…è¦æ—¶åˆ†è¡¨ |
| äº‘å‡½æ•°å†·å¯åŠ¨æ…¢ | ä¸­ | ä½ | é¢„çƒ­ç­–ç•¥ï¼Œä¿æŒæœ€å°å®ä¾‹ |

### è¿è¥é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| æ¶æ„ç”¨æˆ·ç ´åç”Ÿæ€ | ä¸­ | é«˜ | å®Œå–„é£æ§ï¼Œå¿«é€Ÿå“åº”ä¸¾æŠ¥ |
| ç”¨æˆ·å¢é•¿ç¼“æ…¢ | ä¸­ | ä¸­ | ä¼˜åŒ–äº§å“ä½“éªŒï¼Œå£ç¢‘ä¼ æ’­ |
| å¹³å°è§„åˆ™å˜åŒ– | ä½ | é«˜ | å…³æ³¨å¾®ä¿¡æ”¿ç­–ï¼Œçµæ´»è°ƒæ•´ |
| ç«äº‰å¯¹æ‰‹å‡ºç° | é«˜ | ä½ | ä¿æŒåˆ›æ–°ï¼Œç”¨æˆ·ç²˜æ€§ |

### æ³•å¾‹é£é™©

| é£é™© | æ¦‚ç‡ | å½±å“ | åº”å¯¹æªæ–½ |
|------|------|------|----------|
| ç”¨æˆ·éšç§æŠ•è¯‰ | ä½ | é«˜ | ä¸¥æ ¼éµå®ˆéšç§åè®® |
| æŠ½å¥–é“¾æ¥åˆè§„æ€§ | ä½ | é«˜ | å£°æ˜ä»…æä¾›äº’åŠ©å¹³å° |
| ç”¨æˆ·çº çº· | ä¸­ | ä¸­ | å®Œå–„ä¸¾æŠ¥æœºåˆ¶ï¼Œç•™å­˜è¯æ® |

---

## é™„å½•

### A. å…ƒå®é“¾æ¥è§£æ

```javascript
// ç¤ºä¾‹é“¾æ¥
const url = 'https://yb.tencent.com/fes/red/claim?signature=xxx&red_packet_id=xxx'

// è§£æå‡½æ•°
function parseYuanbaoUrl(url) {
  try {
    const urlObj = new URL(url)
    const params = new URLSearchParams(urlObj.search)
    
    return {
      valid: urlObj.hostname === 'yb.tencent.com',
      giftId: params.get('red_packet_id'),
      signature: params.get('signature'),
      path: urlObj.pathname
    }
  } catch (e) {
    return { valid: false }
  }
}
```

### B. è®¾å¤‡æŒ‡çº¹ï¼ˆç®€åŒ–ç‰ˆï¼‰

```javascript
// å‰ç«¯æ”¶é›†
function getDeviceFingerprint() {
  const info = wx.getSystemInfoSync()
  
  const fingerprint = [
    info.platform,
    info.brand,
    info.model,
    info.system,
    info.screenWidth,
    info.screenHeight,
    info.pixelRatio
  ].join('|')
  
  // ç®€å•å“ˆå¸Œ
  return simpleHash(fingerprint)
}

function simpleHash(str) {
  let hash = 0
  for (let i = 0; i < str.length; i++) {
    const char = str.charCodeAt(i)
    hash = ((hash << 5) - hash) + char
    hash = hash & hash
  }
  return hash.toString(16)
}
```

### C. æ˜µç§°æ‰“ç ç®—æ³•

```javascript
function maskNickname(nickname) {
  if (!nickname || nickname.length === 0) {
    return 'ç”¨**'
  }
  
  if (nickname.length <= 2) {
    return nickname[0] + '**'
  }
  
  const first = nickname[0]
  const last = nickname[nickname.length - 1]
  const middle = '*'.repeat(nickname.length - 2)
  
  return first + middle + last
}

// æµ‹è¯•ç”¨ä¾‹
console.log(maskNickname('å¼ ä¸‰'))        // 'å¼ **'
console.log(maskNickname('æå°æ˜'))      // 'æ*æ˜'
console.log(maskNickname('HelloWorld'))  // 'H*******d'
```

### D. æ›å…‰åˆ†æ•°è®¡ç®—

```javascript
function calculateExposureScore(package, config) {
  const now = Date.now()
  const created = package.createdAt.getTime()
  const age = (now - created) / (1000 * 60 * 60) // å°æ—¶æ•°
  
  // åŸºç¡€åˆ†
  let score = 50
  
  // ä¿¡ç”¨ç­‰çº§æƒé‡
  const levelWeights = {
    EXCELLENT: 2.0,
    GOOD: 1.5,
    NORMAL: 1.0,
    WARNING: 0.5,
    RESTRICTED: 0,
    BANNED: 0
  }
  score *= levelWeights[package.creatorLevel] || 1.0
  
  // æ–°é²œåº¦ï¼ˆå‘å¸ƒæ—¶é—´è¶Šè¿‘è¶Šé«˜ï¼‰
  if (age < 1) {
    score += 30 // 1å°æ—¶å†…
  } else if (age < 6) {
    score += 20 // 6å°æ—¶å†…
  } else if (age < 24) {
    score += 10 // 24å°æ—¶å†…
  }
  
  // ç´§æ€¥åº¦ï¼ˆå·®å‡ äººæ»¡ï¼‰
  const remaining = package.maxHelp - package.helpCount
  if (remaining <= 2) {
    score += 15 // å¿«æ»¡äº†ï¼Œç´§æ€¥
  } else if (remaining <= 5) {
    score += 8
  }
  
  // éšæœºå› å­ï¼ˆ0-5åˆ†ï¼Œé˜²æ­¢å®Œå…¨æ’åºï¼‰
  score += Math.random() * 5
  
  return Math.round(score)
}
```

### E. ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | è¯´æ˜ |
|------|------|------|
| v1.0.0 | 2026-02 | åˆå§‹ç‰ˆæœ¬ï¼Œæ ¸å¿ƒåŠŸèƒ½ |
| v1.1.0 | å¾…å®š | OCRè¯†åˆ«ã€æ™ºèƒ½æ¨èä¼˜åŒ– |
| v1.2.0 | å¾…å®š | ç¤¾åŒºåŠŸèƒ½ã€è¯é¢˜è®¨è®º |
| v2.0.0 | å¾…å®š | å¼€æ”¾APIã€å¤šå¹³å°æ”¯æŒ |

---

## è”ç³»æˆ‘ä»¬

- **é¡¹ç›®ä¸»é¡µï¼š** [å¾…æ·»åŠ ]
- **é—®é¢˜åé¦ˆï¼š** [å¾…æ·»åŠ ]
- **ç®¡ç†å‘˜é‚®ç®±ï¼š** [å¾…æ·»åŠ ]

---

**æ–‡æ¡£ç‰ˆæœ¬ï¼š** v1.0.0  
**æœ€åæ›´æ–°ï¼š** 2026-02-02  
**ä½œè€…ï¼š** ç‚¹ç‚¹åœˆå¼€å‘å›¢é˜Ÿ
